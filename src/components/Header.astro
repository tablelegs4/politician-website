---
// ヘッダーコンポーネント（JSなし、details/summaryでSPメニュー実装）
import { THEME_IMAGES, getThemeFromUrl } from '../config/theme';

// URLパラメータからテーマを取得
const currentTheme = getThemeFromUrl(Astro.url);

// URLパラメータを保持する関数
const themeParam = Astro.url.searchParams.get('theme');
const themeQuery = themeParam ? `?theme=${themeParam}` : '';

// ベースパスを適用したパスを生成する関数
const baseUrl = import.meta.env.BASE_URL || '/';
const withBase = (path: string) => {
  if (path.startsWith('http://') || path.startsWith('https://') || path.startsWith('//')) {
    return path;
  }
  const base = baseUrl.endsWith('/') ? baseUrl.slice(0, -1) : baseUrl;
  const cleanPath = path.startsWith('/') ? path : `/${path}`;
  return `${base}${cleanPath}${themeQuery}`;
};

---

<header class="site-header">
  <div class="container">
    <div class="header-inner">
      <div class="site-title">
        <a href={withBase('/')}>
          <img src={THEME_IMAGES[currentTheme].logo} alt="山田太郎" class="header-logo" />
        </a>
      </div>

      <details class="nav-toggle">
        <summary aria-label="メニューを開く">☰</summary>
        <nav class="main-nav" aria-label="メインナビゲーション">
          <ul>
            <li><a href={withBase('/')}>トップ</a></li>
            <li><a href={withBase('/profile/')}>プロフィール</a></li>
            <li><a href={withBase('/policy/')}>政策</a></li>
            <li><a href={withBase('/news/')}>お知らせ</a></li>
            <li><a href={withBase('/contact/')}>お問い合わせ</a></li>
          </ul>
        </nav>
      </details>

      <!-- PC用ナビはCSSで常時表示 -->
      <nav class="main-nav" aria-label="メインナビゲーション">
        <ul>
          <li><a href={withBase('/')}>トップ</a></li>
          <li><a href={withBase('/profile/')}>プロフィール</a></li>
          <li><a href={withBase('/policy/')}>政策</a></li>
          <li><a href={withBase('/news/')}>お知らせ</a></li>
          <li><a href={withBase('/contact/')}>お問い合わせ</a></li>
        </ul>
      </nav>

    </div>
  </div>
</header>
